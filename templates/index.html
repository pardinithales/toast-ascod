<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classificador ASCOD/TOAST - Análise Avançada de AVC</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-brain"></i>
                    <h1>Classificador ASCOD/TOAST</h1>
                </div>
                <p class="subtitle">Sistema Avançado de Análise Etiológica de AVC com Inteligência Artificial</p>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Navigation Tabs -->
            <div class="tabs">
                <button class="tab-button active" data-tab="structured">
                    <i class="fas fa-list-check"></i>
                    Entrada Estruturada
                </button>
                <button class="tab-button" data-tab="text">
                    <i class="fas fa-file-text"></i>
                    Texto Livre
                </button>
            </div>

            <!-- Tab Contents -->
            <div class="tab-content">
                <!-- Structured Input Tab -->
                <div id="structured-tab" class="tab-pane active">
                    <form id="structured-form" class="structured-form">
                        <!-- Fatores de Risco -->
                        <div class="form-section">
                            <h3 class="section-title">
                                <i class="fas fa-heart-pulse"></i>
                                Fatores de Risco Vascular
                            </h3>
                            <div class="form-grid">
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="htn" name="htn">
                                    <label for="htn">Hipertensão (HAS)</label>
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="dm" name="dm">
                                    <label for="dm">Diabetes Mellitus</label>
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="dlp" name="dlp">
                                    <label for="dlp">Dislipidemia</label>
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="smoker" name="smoker">
                                    <label for="smoker">Tabagismo</label>
                                </div>
                            </div>
                        </div>

                        <!-- Achados de Imagem -->
                        <div class="form-section">
                            <h3 class="section-title">
                                <i class="fas fa-x-ray"></i>
                                Achados de Imagem
                            </h3>
                            <div class="form-grid">
                                <div class="form-group">
                                    <label for="stenosis">Estenose Arterial Ipsilateral</label>
                                    <div class="range-input">
                                        <input type="range" id="stenosis" name="stenosis" min="0" max="100" value="0">
                                        <span class="range-value">0%</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="infarct_type">Tipo de Infarto</label>
                                    <select id="infarct_type" name="infarct_type">
                                        <option value="none">Não especificado</option>
                                        <option value="cortical_large">Cortical ou >1.5cm</option>
                                        <option value="subcortical_small_lacunar">Subcortical lacunar (<1.5cm)</option>
                                        <option value="subcortical_other_size">Subcortical não lacunar</option>
                                    </select>
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="leukoaraiosis" name="leukoaraiosis">
                                    <label for="leukoaraiosis">Leucoaraiose presente</label>
                                </div>
                            </div>
                        </div>

                        <!-- Achados Cardíacos -->
                        <div class="form-section">
                            <h3 class="section-title">
                                <i class="fas fa-heart"></i>
                                Avaliação Cardíaca
                            </h3>
                            <div class="form-grid">
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="afib" name="afib">
                                    <label for="afib">Fibrilação/Flutter Atrial</label>
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="mech_valve" name="mech_valve">
                                    <label for="mech_valve">Prótese Valvar Mecânica</label>
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="recent_mi" name="recent_mi">
                                    <label for="recent_mi">IAM Recente (<3 meses)</label>
                                </div>
                                <div class="form-group">
                                    <label for="lvef">Fração de Ejeção do VE</label>
                                    <input type="number" id="lvef" name="lvef" min="0" max="100" placeholder="N/A se não avaliado">
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="thrombus" name="thrombus">
                                    <label for="thrombus">Trombo AE/VE</label>
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="endocarditis" name="endocarditis">
                                    <label for="endocarditis">Endocardite Infecciosa</label>
                                </div>
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="pfo" name="pfo">
                                    <label for="pfo">Forame Oval Patente</label>
                                </div>
                                <div class="form-group checkbox-group" id="venous-thrombosis-group" style="display: none;">
                                    <input type="checkbox" id="venous_thrombosis" name="venous_thrombosis">
                                    <label for="venous_thrombosis">Trombose Venosa Concomitante</label>
                                </div>
                            </div>
                        </div>

                        <!-- Outras Causas -->
                        <div class="form-section">
                            <h3 class="section-title">
                                <i class="fas fa-microscope"></i>
                                Outras Etiologias (O)
                            </h3>
                            <div class="form-subsection">
                                <h4 class="subsection-title">O1: Causa Potencial</h4>
                                <div class="form-grid-checkboxes">
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o1_polycythemia" name="o1_polycythemia"><label for="o1_polycythemia">Policitemia/Trombocitemia (>800.000)</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o1_fabry" name="o1_fabry"><label for="o1_fabry">Doença de Fabry</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o1_antiphospholipid" name="o1_antiphospholipid"><label for="o1_antiphospholipid">Sd. Antifosfolípide (>100 GPL ou lúpus anticoag.)</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o1_meningitis" name="o1_meningitis"><label for="o1_meningitis">Meningite coexistente</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o1_sickle_cell" name="o1_sickle_cell"><label for="o1_sickle_cell">Anemia Falciforme</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o1_hyperhomocysteinemia" name="o1_hyperhomocysteinemia"><label for="o1_hyperhomocysteinemia">Hiper-homocisteinemia grave</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o1_moyamoya" name="o1_moyamoya"><label for="o1_moyamoya">Doença de Moyamoya</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o1_other_angiitis" name="o1_other_angiitis"><label for="o1_other_angiitis">Outra angiite cerebral</label></div>
                                </div>
                            </div>
                            <div class="form-subsection">
                                <h4 class="subsection-title">O2: Ligação Causal Incerta</h4>
                                <div class="form-grid-checkboxes">
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o2_aneurysm" name="o2_aneurysm"><label for="o2_aneurysm">Aneurisma sacular com suspeita de embolia</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o2_migraine" name="o2_migraine"><label for="o2_migraine">Ataque de enxaqueca com déficit >60 min</label></div>
                                </div>
                            </div>
                            <div class="form-subsection">
                                <h4 class="subsection-title">O3: Doença Presente, Ligação Causal Improvável</h4>
                                <div class="form-grid-checkboxes">
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o3_avm" name="o3_avm"><label for="o3_avm">Malformação arteriovenosa</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o3_thrombocytosis" name="o3_thrombocytosis"><label for="o3_thrombocytosis">Trombocitose <800.000</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o3_antiphospholipid_low" name="o3_antiphospholipid_low"><label for="o3_antiphospholipid_low">Ac. Antifosfolípide <100 GPL</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o3_homocysteinemia_low" name="o3_homocysteinemia_low"><label for="o3_homocysteinemia_low">Homocisteinemia <40 μmol/l</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="o3_malignancy" name="o3_malignancy"><label for="o3_malignancy">Malignidade com hipercoagulação</label></div>
                                </div>
                            </div>
                        </div>

                        <!-- Dissecção -->
                        <div class="form-section">
                            <h3 class="section-title">
                                <i class="fas fa-code-branch"></i>
                                Dissecção Arterial (D)
                            </h3>
                           <div class="form-subsection">
                                <h4 class="subsection-title">D1: Causa Potencial (Demonstração Direta/Indireta)</h4>
                                <div class="form-grid-checkboxes">
                                    <div class="form-group checkbox-group"><input type="checkbox" id="d1_direct" name="d1_direct"><label for="d1_direct">Demonstração direta de hematoma mural (RNM, TC, US)</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="d1_indirect" name="d1_indirect"><label for="d1_indirect">Demonstração indireta (estenose longa, recanalização)</label></div>
                                </div>
                            </div>
                            <div class="form-subsection">
                                <h4 class="subsection-title">D2: Ligação Causal Incerta</h4>
                                <div class="form-grid-checkboxes">
                                    <div class="form-group checkbox-group"><input type="checkbox" id="d2_weak_evidence" name="d2_weak_evidence"><label for="d2_weak_evidence">Evidência fraca (história clínica sugestiva, Sd. Horner doloroso)</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="d2_fibromuscular" name="d2_fibromuscular"><label for="d2_fibromuscular">Displasia fibromuscular na artéria isquêmica</label></div>
                                </div>
                            </div>
                            <div class="form-subsection">
                                <h4 class="subsection-title">D3: Doença Presente, Ligação Causal Improvável</h4>
                                <div class="form-grid-checkboxes">
                                    <div class="form-group checkbox-group"><input type="checkbox"id="d3_kinking" name="d3_kinking"><label for="d3_kinking">Kinking/Dolicoectasia sem aneurisma complicado</label></div>
                                    <div class="form-group checkbox-group"><input type="checkbox" id="d3_fibromuscular_other" name="d3_fibromuscular_other"><label for="d3_fibromuscular_other">Displasia fibromuscular em outras artérias</label></div>
                                </div>
                            </div>
                        </div>

                        <button type="submit" class="submit-button">
                            <i class="fas fa-brain"></i>
                            Analisar com IA
                        </button>
                    </form>
                </div>

                <!-- Text Input Tab -->
                <div id="text-tab" class="tab-pane">
                    <form id="text-form" class="text-form">
                        <div class="form-group">
                            <label for="clinical-text">Descrição Clínica do Caso</label>
                            <textarea id="clinical-text" name="clinical-text" rows="15" 
                                placeholder="Cole aqui a descrição completa do caso clínico, incluindo história, exames físicos, achados de imagem, avaliação vascular e cardíaca..."></textarea>
                        </div>
                        <button type="submit" class="submit-button">
                            <i class="fas fa-brain"></i>
                            Analisar com IA
                        </button>
                    </form>
                </div>
            </div>

            <!-- Results Section -->
            <div id="results-section" class="results-section" style="display: none;">
                <h2 class="results-title">
                    <i class="fas fa-clipboard-check"></i>
                    Resultados da Análise
                </h2>
                
                <div class="results-grid">
                    <!-- ASCOD Result Card -->
                    <div class="result-card ascod-card">
                        <div class="card-header">
                            <h3>Classificação ASCOD</h3>
                            <div class="classification-badge" id="ascod-badge">-</div>
                        </div>
                        <div class="card-body" id="ascod-details">
                            <div class="loading">
                                <i class="fas fa-spinner fa-spin"></i>
                                Processando...
                            </div>
                        </div>
                    </div>

                    <!-- TOAST Result Card -->
                    <div class="result-card toast-card">
                        <div class="card-header">
                            <h3>Classificação TOAST</h3>
                            <div class="classification-badge" id="toast-badge">-</div>
                        </div>
                        <div class="card-body" id="toast-details">
                            <div class="loading">
                                <i class="fas fa-spinner fa-spin"></i>
                                Processando...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Full Analysis -->
                <div class="full-analysis">
                    <h3>Análise Completa</h3>
                    <div id="full-analysis-content" class="analysis-content"></div>
                </div>

                <button class="new-analysis-button" onclick="resetAnalysis()">
                    <i class="fas fa-redo"></i>
                    Nova Análise
                </button>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2024 Classificador ASCOD/TOAST - Desenvolvido com IA Gemini</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html> 